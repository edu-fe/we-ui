<!-- JiaThis Button BEGIN -->
<div class="jiathis_style">
<a class="jiathis_button_weixin">微信</a>
<a class="jiathis_button_qzone">QQ空间</a>
<a class="jiathis_button_cqq">QQ好友</a>
<a class="jiathis_button_tsina">新浪微薄</a>

<!-- <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank">更多</a> -->
</div>
<style type="text/css">
	a[title] {
		display: block;
		clear: both;
		text-decoration: none;
		padding: 8px 0;
		cursor: pointer;
	}
	.jiathis_modal_footer{
		display: none;
	}
	h3{
		font-size: 18px;
	}
	#jiathis_weixin_modal{
		width: 300px !important;
		height: 300px !important;
		top: 0 !important;
		left: 0 !important;
		margin: 0 !important;
	}
	p{
		margin: 0;
	}
	.jiathis_style{
		padding: 15px;
		width: 90px;
		height: 110px;
		background: #fff;
		border: 1px solid #ddd;
	}
</style>
<script type="text/javascript" >
	if(!!localStorage.currentDetails) {
		var currentDetails = JSON.parse(localStorage.currentDetails)
	}

	/**
	 * 解析window.location.serch
	 */
	function getSeachByName(name) {
		var reg = new RegExp("[?|&]" + name + "=([^&]*)(&|$)", "i");
		var r = window.parent.location.href.match(reg);
		if(r != null) return(r[1].split('#')[0]);
		return null;
	}

	// 获取html代码的纯文本
	function removeHTMLTag(str) {
            str = str.replace(/<\/?[^>]*>/g,''); //去除HTML tag
            str = str.replace(/[ | ]*\n/g,'\n'); //去除行尾空白
            //str = str.replace(/\n[\s| | ]*\r/g,'\n'); //去除多余空行
            str=str.replace(/&nbsp;/ig,'');//去掉&nbsp;
            str=str.replace(/\s/g,''); //将空格去掉
            // 最多100字
            str = str.substr(0, 100) + '...'
            return str;
	}

	// 处理url
	function doUrl() {
		var query = '&releaseId=' + window.parent.location.hash.split('/')[3] + '&topicId=' + getSeachByName('topicId')+'&type=' + getSeachByName('type') + '&FileServerUrl=' + window.parent.FileServerUrl
        switch (getSeachByName('type')){
        	case '1':
        		return 'page=shareTopic' + query
        		break;
        	case '2':
        		if(!!getSeachByName('opusId')) { // 写作详情页
        			return 'page=shareWritingDetail' + query
        		} else { // 写作列表页
        			return 'page=shareWritingList' + query
        		}
        		break;
        	case '3':
        		return 'page=shareGroup' + query
        		break;
        	default:
        		break;
        }
	}

	var jiathis_config={
		siteNum:4,
		sm:"weixin,qzone,cqq,tsina",
		boldNum:3,
		title: getSeachByName('title')?getSeachByName('title'):(currentDetails? currentDetails.title:'暂无标题'),
		summary: getSeachByName('summary')?getSeachByName('summary'):(currentDetails? removeHTMLTag(currentDetails.content):'暂无内容'),
		url: window.parent.location.href.split("#")[0] + '?' + doUrl(),
		shortUrl:true,
		hideMore:true
	}
</script>
<script type="text/javascript" src="http://v3.jiathis.com/code_mini/jia.js" charset="utf-8"></script>
<!-- JiaThis Button END -->
